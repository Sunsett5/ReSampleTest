nohup: ignoring input
Device set to cuda:0.
Loading model from models/ldm/model.ckpt
/home/workspace/sun/ReSampleTest/model_loader.py:13: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pl_sd = torch.load(ckpt)#, map_location="cpu")
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 274.06 M params.
Keeping EMAs of 370.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 3, 64, 64) = 12288 dimensions.
making attention of type 'vanilla' with 512 in_channels
/home/workspace/sun/ReSampleTest/ldm/models/autoencoder.py:79: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sd = torch.load(path, map_location="cpu")["state_dict"]
Restored from models/first_stage_models/vq-f4/model.ckpt with 0 missing and 55 unexpected keys
Training LatentDiffusion as an unconditional model.
Operation: motion_blur / Noise: gaussian
Condition <ldm_inverse.condition_methods.PosteriorSampling object at 0x7583595cad10>
Conditioning method <bound method PosteriorSampling.conditioning of <ldm_inverse.condition_methods.PosteriorSampling object at 0x7583595cad10>>
Conditioning sampler : resample
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
Inference for image 0
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
/home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
/home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/lpips.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location='cpu'), strict=False)
measurement psnr:  33.13487612583194
measurement nmse:  0.005742390174418688
measurement ssim:  0.8849872
measurement lpips:  0.21374797821044922
Inference for image 1
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.9564013194044
measurement nmse:  0.004433769267052412
measurement ssim:  0.83855796
measurement lpips:  0.21002459526062012
Inference for image 2
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  22.72046614637332
measurement nmse:  0.019521944224834442
measurement ssim:  0.68273705
measurement lpips:  0.32114917039871216
Inference for image 3
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  32.022178868651416
measurement nmse:  0.0013973225140944123
measurement ssim:  0.9189299
measurement lpips:  0.11011706292629242
Inference for image 4
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  31.427361118372925
measurement nmse:  0.0035405224189162254
measurement ssim:  0.8906503
measurement lpips:  0.20695608854293823
Inference for image 5
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.59160931513061
measurement nmse:  0.0048452396877110004
measurement ssim:  0.8856718
measurement lpips:  0.19177553057670593
Inference for image 6
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.131877987985032
measurement nmse:  0.005091713275760412
measurement ssim:  0.78462917
measurement lpips:  0.24904444813728333
Inference for image 7
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.63896716826366
measurement nmse:  0.0053848749957978725
measurement ssim:  0.8095004
measurement lpips:  0.29157909750938416
Inference for image 8
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.40143513572918
measurement nmse:  0.005303692538291216
measurement ssim:  0.7494728
measurement lpips:  0.2997097969055176
Inference for image 9
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.878325853125986
measurement nmse:  0.0025114407762885094
measurement ssim:  0.8746255
measurement lpips:  0.16497497260570526
Inference for image 10
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.889219207904315
measurement nmse:  0.018383318558335304
measurement ssim:  0.8165906
measurement lpips:  0.25437667965888977
Inference for image 11
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.93511170399904
measurement nmse:  0.005649225320667028
measurement ssim:  0.84343505
measurement lpips:  0.1671416163444519
Inference for image 12
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  31.510264910566306
measurement nmse:  0.0028649952728301287
measurement ssim:  0.8548086
measurement lpips:  0.25864672660827637
Inference for image 13
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.426485928797938
measurement nmse:  0.0035094507038593292
measurement ssim:  0.8531955
measurement lpips:  0.17232099175453186
Inference for image 14
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  27.21861185838722
measurement nmse:  0.00974932312965393
measurement ssim:  0.8147664
measurement lpips:  0.24264593422412872
Inference for image 15
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  34.20761959547566
measurement nmse:  0.0029415665194392204
measurement ssim:  0.9052596
measurement lpips:  0.19216054677963257
Inference for image 16
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  31.066346247066168
measurement nmse:  0.001590088359080255
measurement ssim:  0.8962021
measurement lpips:  0.15271970629692078
Inference for image 17
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.958291733376065
measurement nmse:  0.0032708020880818367
measurement ssim:  0.8294439
measurement lpips:  0.21363069117069244
Inference for image 18
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.7686817184802
measurement nmse:  0.005600884091109037
measurement ssim:  0.83981687
measurement lpips:  0.272419273853302
Inference for image 19
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /home/workspace/sun/ReSampleTest/ReSampleTest/lib/python3.10/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.02478714342822
measurement nmse:  0.006584966089576483
measurement ssim:  0.8790315
measurement lpips:  0.157941073179245
