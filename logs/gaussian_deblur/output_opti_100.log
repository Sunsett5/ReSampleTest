nohup: ignoring input
Device set to cuda:0.
Loading model from models/ldm/model.ckpt
/data/sun/ReSampleTest/model_loader.py:13: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pl_sd = torch.load(ckpt)#, map_location="cpu")
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 274.06 M params.
Keeping EMAs of 370.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 3, 64, 64) = 12288 dimensions.
making attention of type 'vanilla' with 512 in_channels
/data/sun/ReSampleTest/ldm/models/autoencoder.py:79: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sd = torch.load(path, map_location="cpu")["state_dict"]
Restored from models/first_stage_models/vq-f4/model.ckpt with 0 missing and 55 unexpected keys
Training LatentDiffusion as an unconditional model.
Operation: gaussian_blur / Noise: gaussian
Condition <ldm_inverse.condition_methods.PosteriorSampling object at 0x7ff01403e640>
Conditioning method <bound method PosteriorSampling.conditioning of <ldm_inverse.condition_methods.PosteriorSampling object at 0x7ff01403e640>>
Conditioning sampler : resample
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
Inference for image 0
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
DDIM Sampler: 100%|██████████| 500/500 [03:18<00:00,  2.52it/s]
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
/data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
/data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/lpips.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location='cpu'), strict=False)
measurement psnr:  32.02182840747397
measurement nmse:  0.007363753858953714
measurement ssim:  0.85676354
measurement lpips:  0.28373220562934875
Inference for image 1
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  27.789930077398502
measurement nmse:  0.005789151415228844
measurement ssim:  0.8039753
measurement lpips:  0.2631843090057373
Inference for image 2
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  21.749235946217702
measurement nmse:  0.024409636855125427
measurement ssim:  0.61102897
measurement lpips:  0.3721177875995636
Inference for image 3
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.718372316469605
measurement nmse:  0.0023731349501758814
measurement ssim:  0.8937245
measurement lpips:  0.1502888947725296
Inference for image 4
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.457053449261238
measurement nmse:  0.005358169320970774
measurement ssim:  0.8654123
measurement lpips:  0.2634376585483551
Inference for image 5
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.29279787217579
measurement nmse:  0.00658619636669755
measurement ssim:  0.86167735
measurement lpips:  0.259954571723938
Inference for image 6
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  27.867088795737466
measurement nmse:  0.006788162514567375
measurement ssim:  0.7317805
measurement lpips:  0.3189200162887573
Inference for image 7
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.822343909689067
measurement nmse:  0.0064939651638269424
measurement ssim:  0.7880047
measurement lpips:  0.31787607073783875
Inference for image 8
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.629206874786554
measurement nmse:  0.006296078208833933
measurement ssim:  0.71933794
measurement lpips:  0.35445141792297363
Inference for image 9
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  27.75570833611632
measurement nmse:  0.0032484864350408316
measurement ssim:  0.8470667
measurement lpips:  0.2021903246641159
Inference for image 10
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.79309407376217
measurement nmse:  0.023632073774933815
measurement ssim:  0.78624415
measurement lpips:  0.30214229226112366
Inference for image 11
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.363610042552256
measurement nmse:  0.008173868991434574
measurement ssim:  0.81156015
measurement lpips:  0.2190978229045868
Inference for image 12
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.176952787962577
measurement nmse:  0.003885571612045169
measurement ssim:  0.8302751
measurement lpips:  0.3068859875202179
Inference for image 13
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  27.12636358396845
measurement nmse:  0.00587310129776597
measurement ssim:  0.80740327
measurement lpips:  0.2604224383831024
Inference for image 14
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  25.35327989779529
measurement nmse:  0.014944538474082947
measurement ssim:  0.7825516
measurement lpips:  0.2924562096595764
Inference for image 15
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  32.63576855127082
measurement nmse:  0.0042467969469726086
measurement ssim:  0.8877192
measurement lpips:  0.22730159759521484
Inference for image 16
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.663798940440643
measurement nmse:  0.0027681859210133553
measurement ssim:  0.8524122
measurement lpips:  0.20900598168373108
Inference for image 17
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.206789282236016
measurement nmse:  0.0039029987528920174
measurement ssim:  0.81099534
measurement lpips:  0.26615557074546814
Inference for image 18
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  27.327390090975715
measurement nmse:  0.009715214371681213
measurement ssim:  0.8014789
measurement lpips:  0.33465805649757385
Inference for image 19
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  27.599932213545696
measurement nmse:  0.008988759480416775
measurement ssim:  0.85171
measurement lpips:  0.20482085645198822
