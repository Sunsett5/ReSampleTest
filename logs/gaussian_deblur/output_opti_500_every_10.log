nohup: ignoring input
Device set to cuda:0.
Loading model from models/ldm/model.ckpt
/data/sun/ReSampleTest/model_loader.py:13: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pl_sd = torch.load(ckpt)#, map_location="cpu")
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 274.06 M params.
Keeping EMAs of 370.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 3, 64, 64) = 12288 dimensions.
making attention of type 'vanilla' with 512 in_channels
/data/sun/ReSampleTest/ldm/models/autoencoder.py:79: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sd = torch.load(path, map_location="cpu")["state_dict"]
Restored from models/first_stage_models/vq-f4/model.ckpt with 0 missing and 55 unexpected keys
Training LatentDiffusion as an unconditional model.
Operation: gaussian_blur / Noise: gaussian
Condition <ldm_inverse.condition_methods.PosteriorSampling object at 0x7f52180c76a0>
Conditioning method <bound method PosteriorSampling.conditioning of <ldm_inverse.condition_methods.PosteriorSampling object at 0x7f52180c76a0>>
Conditioning sampler : resample
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
Inference for image 0
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
/data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
/data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/lpips.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.load_state_dict(torch.load(model_path, map_location='cpu'), strict=False)
measurement psnr:  32.66324154740009
measurement nmse:  0.006374724209308624
measurement ssim:  0.87107134
measurement lpips:  0.22916820645332336
Inference for image 1
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.331652642610162
measurement nmse:  0.0050897845067083836
measurement ssim:  0.8223243
measurement lpips:  0.23128513991832733
Inference for image 2
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  22.270360094570147
measurement nmse:  0.021633336320519447
measurement ssim:  0.6490883
measurement lpips:  0.3389422297477722
Inference for image 3
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.13661758980916
measurement nmse:  0.002157060196623206
measurement ssim:  0.90272254
measurement lpips:  0.13730423152446747
Inference for image 4
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.279118111290437
measurement nmse:  0.004510671831667423
measurement ssim:  0.87731475
measurement lpips:  0.228034108877182
Inference for image 5
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.227718771196578
measurement nmse:  0.005276541691273451
measurement ssim:  0.8793943
measurement lpips:  0.22338858246803284
Inference for image 6
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.425893407422365
measurement nmse:  0.005981059744954109
measurement ssim:  0.7527279
measurement lpips:  0.29272696375846863
Inference for image 7
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.03887426005634
measurement nmse:  0.006186137441545725
measurement ssim:  0.790801
measurement lpips:  0.2903011739253998
Inference for image 8
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.215715585890205
measurement nmse:  0.005529297981411219
measurement ssim:  0.75066066
measurement lpips:  0.30481356382369995
Inference for image 9
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.267417781861923
measurement nmse:  0.002888232469558716
measurement ssim:  0.8639844
measurement lpips:  0.1744784414768219
Inference for image 10
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.461609320947716
measurement nmse:  0.020282907411456108
measurement ssim:  0.8092386
measurement lpips:  0.26589658856391907
Inference for image 11
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.98319989304727
measurement nmse:  0.007078676018863916
measurement ssim:  0.8192768
measurement lpips:  0.19874200224876404
Inference for image 12
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.64729472740718
measurement nmse:  0.0034745018929243088
measurement ssim:  0.84370416
measurement lpips:  0.2778030335903168
Inference for image 13
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.04608473141493
measurement nmse:  0.004782379604876041
measurement ssim:  0.8298449
measurement lpips:  0.23147866129875183
Inference for image 14
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  26.079599135870136
measurement nmse:  0.012624072842299938
measurement ssim:  0.8024295
measurement lpips:  0.2516248822212219
Inference for image 15
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  32.943195490018795
measurement nmse:  0.003977703396230936
measurement ssim:  0.8895022
measurement lpips:  0.20741060376167297
Inference for image 16
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  29.641007936578802
measurement nmse:  0.0022093236912041903
measurement ssim:  0.8712836
measurement lpips:  0.18036331236362457
Inference for image 17
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  30.488111364889853
measurement nmse:  0.0036539884749799967
measurement ssim:  0.8146129
measurement lpips:  0.24034050107002258
Inference for image 18
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.267891349834887
measurement nmse:  0.00786418467760086
measurement ssim:  0.8219063
measurement lpips:  0.29716256260871887
Inference for image 19
Data shape for DDIM sampling is (1, 3, 64, 64), eta 0.0
Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /data/sun/ReSampleTest/ReSample/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
measurement psnr:  28.177741771285234
measurement nmse:  0.007933895103633404
measurement ssim:  0.8657572
measurement lpips:  0.1769849956035614
